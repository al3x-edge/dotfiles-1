#!/usr/bin/env bash

# To run this, you must download & install the latest Xcode App and the latest Commandline Tools
# https://developer.apple.com/xcode/
# https://developer.apple.com/downloads/

# Ask for the administrator password upfront
sudo -v


formulae="node"

function installPackages {
  # Install Node Package Manager
  curl https://npmjs.org/install.sh | sh

  # Point the NODE_PATH to the correct place to find Node modules
  export NODE_PATH="/usr/local/lib/node"
   
  # export $PATH since some node modules have execute files
  export PATH="/usr/local/share/npm/bin:$PATH"
    
  # Install NPM Packages
  npm install -g bower
  npm install -g grunt-cli
  npm install -g less
}


# Install Homebrew Node Package
# ----------------------------------------------------------------------
if brew which "$formulae" | grep "Not Installed" > /dev/null; then 
  read -p "brew $formulae is not installed, would you like to install it? [y/n]" respond
  
  if [ "$respond" = "y" ]; then
    # Install NodeJS via Homebrew
    brew install node
  elif [ "$respond" = "n"]; then
    echo "ðŸš«  no balls to do it huh? now aborting..."
    exit
  fi
  
  # Done Iinstalling Node and NodePackageManager
  echo "Installing Packages..."
  installPackages
else
  echo "Installing Packages..."
  installPackages
fi

echo "âœ…  Installed NodeJS and Packages"